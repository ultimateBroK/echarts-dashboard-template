<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Tabs - ECharts Dashboard</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #1a1a1a;
            color: white;
        }
        .test-section { 
            margin: 20px 0; 
            padding: 20px; 
            border: 1px solid #333;
            border-radius: 8px;
            background: #2a2a2a;
        }
        .test-button {
            padding: 10px 15px;
            margin: 5px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            background: #333;
            border-radius: 5px;
            max-height: 300px;
            overflow-y: auto;
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .warning { color: #ffc107; }
    </style>
</head>
<body>
    <h1>üß™ Test Tabs - ECharts Dashboard</h1>
    
    <div class="test-section">
        <h2>üìä Ki·ªÉm tra Dashboard</h2>
        <button class="test-button" onclick="openDashboard()">M·ªü Dashboard</button>
        <button class="test-button" onclick="testAllTabs()">Test T·∫•t C·∫£ Tabs</button>
        <button class="test-button" onclick="checkChartStatus()">Ki·ªÉm tra Charts</button>
        <button class="test-button" onclick="testTabSwitching()">Test Chuy·ªÉn Tab</button>
        <div id="dashboard-result" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>üîß Debug Tools</h2>
        <button class="test-button" onclick="runDebugCommand()">Ch·∫°y Debug Command</button>
        <button class="test-button" onclick="clearResults()">X√≥a K·∫øt Qu·∫£</button>
        <div id="debug-result" class="result"></div>
    </div>

    <script>
        let dashboardWindow = null;
        
        function openDashboard() {
            const result = document.getElementById('dashboard-result');
            result.innerHTML = '<div class="warning">‚è≥ ƒêang m·ªü dashboard...</div>';
            
            dashboardWindow = window.open('index.html', 'dashboard', 'width=1400,height=900');
            
            if (dashboardWindow) {
                result.innerHTML = '<div class="success">‚úÖ Dashboard ƒë√£ ƒë∆∞·ª£c m·ªü th√†nh c√¥ng!</div>';
                
                // Wait for dashboard to load and run tests
                setTimeout(() => {
                    if (dashboardWindow && !dashboardWindow.closed) {
                        result.innerHTML += '<div class="success">‚úÖ Dashboard ƒëang ch·∫°y</div>';
                    } else {
                        result.innerHTML += '<div class="error">‚ùå Dashboard b·ªã ƒë√≥ng ho·∫∑c kh√¥ng m·ªü ƒë∆∞·ª£c</div>';
                    }
                }, 2000);
            } else {
                result.innerHTML = '<div class="error">‚ùå Kh√¥ng th·ªÉ m·ªü dashboard. Ki·ªÉm tra popup blocker.</div>';
            }
        }
        
        function testAllTabs() {
            const result = document.getElementById('dashboard-result');
            
            if (!dashboardWindow || dashboardWindow.closed) {
                result.innerHTML += '<div class="error">‚ùå Vui l√≤ng m·ªü dashboard tr∆∞·ªõc</div>';
                return;
            }
            
            try {
                const tabs = ['overview', 'detailed', 'analytics', 'exports'];
                let testResults = '<div class="warning">üß™ ƒêang test t·∫•t c·∫£ tabs...</div>';
                result.innerHTML += testResults;
                
                tabs.forEach((tab, index) => {
                    setTimeout(() => {
                        try {
                            const tabButton = dashboardWindow.document.querySelector(`[data-tab="${tab}"]`);
                            if (tabButton) {
                                tabButton.click();
                                result.innerHTML += `<div class="success">‚úÖ Tab ${tab} - OK</div>`;
                            } else {
                                result.innerHTML += `<div class="error">‚ùå Tab ${tab} - Kh√¥ng t√¨m th·∫•y button</div>`;
                            }
                        } catch (error) {
                            result.innerHTML += `<div class="error">‚ùå Tab ${tab} - L·ªói: ${error.message}</div>`;
                        }
                    }, index * 1000);
                });
                
            } catch (error) {
                result.innerHTML += `<div class="error">‚ùå L·ªói khi test tabs: ${error.message}</div>`;
            }
        }
        
        function checkChartStatus() {
            const result = document.getElementById('dashboard-result');
            
            if (!dashboardWindow || dashboardWindow.closed) {
                result.innerHTML += '<div class="error">‚ùå Vui l√≤ng m·ªü dashboard tr∆∞·ªõc</div>';
                return;
            }
            
            try {
                // Call debug function in dashboard
                if (dashboardWindow.debugAppStatus) {
                    dashboardWindow.debugAppStatus();
                    result.innerHTML += '<div class="success">‚úÖ Debug info ƒë√£ ƒë∆∞·ª£c in ra console c·ªßa dashboard</div>';
                } else {
                    result.innerHTML += '<div class="warning">‚ö†Ô∏è Debug function kh√¥ng t·ªìn t·∫°i</div>';
                }
                
                // Check charts object
                if (dashboardWindow.charts) {
                    const chartCount = Object.keys(dashboardWindow.charts).length;
                    result.innerHTML += `<div class="success">‚úÖ C√≥ ${chartCount} charts ƒë∆∞·ª£c kh·ªüi t·∫°o</div>`;
                } else {
                    result.innerHTML += '<div class="error">‚ùå Charts object kh√¥ng t·ªìn t·∫°i</div>';
                }
                
            } catch (error) {
                result.innerHTML += `<div class="error">‚ùå L·ªói khi ki·ªÉm tra charts: ${error.message}</div>`;
            }
        }
        
        function testTabSwitching() {
            const result = document.getElementById('dashboard-result');
            
            if (!dashboardWindow || dashboardWindow.closed) {
                result.innerHTML += '<div class="error">‚ùå Vui l√≤ng m·ªü dashboard tr∆∞·ªõc</div>';
                return;
            }
            
            result.innerHTML += '<div class="warning">üîÑ ƒêang test chuy·ªÉn ƒë·ªïi tabs...</div>';
            
            const tabs = ['overview', 'detailed', 'analytics', 'exports'];
            let currentIndex = 0;
            
            const switchTab = () => {
                if (currentIndex >= tabs.length) {
                    result.innerHTML += '<div class="success">‚úÖ Ho√†n th√†nh test chuy·ªÉn ƒë·ªïi tabs</div>';
                    return;
                }
                
                const tab = tabs[currentIndex];
                try {
                    const tabButton = dashboardWindow.document.querySelector(`[data-tab="${tab}"]`);
                    if (tabButton) {
                        tabButton.click();
                        result.innerHTML += `<div class="success">‚úÖ Chuy·ªÉn sang tab ${tab}</div>`;
                        
                        // Check if tab content is visible
                        setTimeout(() => {
                            const tabContent = dashboardWindow.document.getElementById(`${tab}-tab`);
                            if (tabContent && tabContent.classList.contains('active')) {
                                result.innerHTML += `<div class="success">‚úÖ Tab ${tab} hi·ªÉn th·ªã ƒë√∫ng</div>`;
                            } else {
                                result.innerHTML += `<div class="error">‚ùå Tab ${tab} kh√¥ng hi·ªÉn th·ªã ƒë√∫ng</div>`;
                            }
                        }, 500);
                        
                    } else {
                        result.innerHTML += `<div class="error">‚ùå Kh√¥ng t√¨m th·∫•y button cho tab ${tab}</div>`;
                    }
                } catch (error) {
                    result.innerHTML += `<div class="error">‚ùå L·ªói khi chuy·ªÉn tab ${tab}: ${error.message}</div>`;
                }
                
                currentIndex++;
                setTimeout(switchTab, 1500);
            };
            
            switchTab();
        }
        
        function runDebugCommand() {
            const result = document.getElementById('debug-result');
            
            if (!dashboardWindow || dashboardWindow.closed) {
                result.innerHTML = '<div class="error">‚ùå Vui l√≤ng m·ªü dashboard tr∆∞·ªõc</div>';
                return;
            }
            
            try {
                if (dashboardWindow.debugAppStatus) {
                    dashboardWindow.debugAppStatus();
                    
                    // Get some basic info
                    const chartCount = dashboardWindow.charts ? Object.keys(dashboardWindow.charts).length : 0;
                    const activeTab = dashboardWindow.document.querySelector('.tab-content.active');
                    const activeTabId = activeTab ? activeTab.id : 'none';
                    
                    result.innerHTML = `
                        <div class="success">‚úÖ Debug command executed</div>
                        <div>üìä Charts initialized: ${chartCount}</div>
                        <div>üéØ Active tab: ${activeTabId}</div>
                        <div>üíæ Data available: ${!!dashboardWindow.lastFetchedData}</div>
                        <div class="warning">‚ÑπÔ∏è Chi ti·∫øt xem trong console c·ªßa dashboard</div>
                    `;
                } else {
                    result.innerHTML = '<div class="error">‚ùå Debug function kh√¥ng t·ªìn t·∫°i</div>';
                }
            } catch (error) {
                result.innerHTML = `<div class="error">‚ùå L·ªói: ${error.message}</div>`;
            }
        }
        
        function clearResults() {
            document.getElementById('dashboard-result').innerHTML = '';
            document.getElementById('debug-result').innerHTML = '';
        }
        
        // Auto-check if dashboard is already open
        window.addEventListener('load', () => {
            console.log('Test page loaded');
        });
    </script>
</body>
</html> 